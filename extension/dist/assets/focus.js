import"./styles.js";import{r as d,j as e,R as j,a as k}from"./client.js";import{W as v}from"./constants.js";const B=()=>{const[n,l]=d.useState(null),[m,u]=d.useState(Date.now());d.useEffect(()=>{chrome.storage.local.get(["sfState"],o=>{const s=o.sfState;s?.activeSession?l(s.activeSession):chrome.storage.local.get(["activeSession"],r=>{r.activeSession&&l(r.activeSession)})});const i=(o,s)=>{s==="local"&&(o.sfState?.newValue?.activeSession?l(o.sfState.newValue.activeSession):o.activeSession&&l(o.activeSession.newValue))};return chrome.storage.onChanged.addListener(i),()=>chrome.storage.onChanged.removeListener(i)},[]),d.useEffect(()=>{const i=setInterval(()=>u(Date.now()),1e3);return()=>clearInterval(i)},[]);function p(i){const o=Math.floor(i/60),s=i%60;return o>0?`${o}h ${s}m`:`${s}m`}function h(){if(!n)return null;const i=n.entries[n.currentIndex];if(!i)return null;const o=i.estimatedMinutes*6e4,s=m-n.phaseStartedAt,r=Math.max(0,o-s),y=Math.floor(r/6e4),S=Math.floor(r%6e4/1e3);return{formatted:`${y}:${S.toString().padStart(2,"0")}`,isComplete:r===0,isBreak:i.isBreak,progress:o?Math.min(100,(o-r)/o*100):0}}function f(){chrome.runtime.sendMessage({type:"SF_END_SESSION"},()=>{window.location.href="chrome://newtab/"})}function x(){window.open(v,"_blank")}if(!n)return e.jsx("div",{style:t.container,children:e.jsx("div",{style:t.panel,children:e.jsxs("div",{style:t.hero,children:[e.jsx("div",{style:t.icon,children:"ðŸŽ¯"}),e.jsx("h1",{style:t.title,children:"Stay Focused"}),e.jsx("p",{style:t.subtitle,children:"No active focus session detected."}),e.jsx("button",{onClick:x,style:t.primaryButton,children:"Open Study Focus Web App"})]})})});const a=h(),c=n.entries[n.currentIndex],b=n.entries.length>0?(n.currentIndex+1)/n.entries.length*100:0,g=n.entries.slice(n.currentIndex+1);return e.jsx("div",{style:t.container,children:e.jsxs("div",{style:t.panel,children:[e.jsx("div",{style:t.header,children:e.jsxs("div",{style:t.headerContent,children:[e.jsx("div",{style:t.icon,children:"ðŸš«"}),e.jsxs("div",{children:[e.jsx("h1",{style:t.mainTitle,children:"Blocked for Focus"}),e.jsx("p",{style:t.headerSubtitle,children:"This site is restricted during your focus session. Use the web app to manage your session."})]})]})}),e.jsxs("div",{style:t.timerSection,children:[e.jsxs("div",{style:t.timerCard,children:[e.jsx("div",{style:t.timerLabel,children:a?.isBreak?"Break Time Remaining":"Time Remaining"}),e.jsx("div",{style:t.timerDisplay,children:a?.formatted||"--:--"}),a?.isComplete&&e.jsx("div",{style:t.completeMessage,children:"Time's up! Ready to continue?"}),e.jsx("div",{style:t.progressBar,children:e.jsx("div",{style:{...t.progressFill,width:`${a?.progress||0}%`}})})]}),e.jsxs("div",{style:t.currentTaskCard,children:[e.jsxs("div",{style:t.taskLabel,children:["Current ",a?.isBreak?"Break":"Task"]}),e.jsx("div",{style:t.taskName,children:c?.title||"N/A"}),e.jsx("div",{style:t.taskInfo,children:c?.isBreak?"Enjoy a 5-minute recharge":`Allocated: ${p(c?.estimatedMinutes??0)}`}),e.jsxs("div",{style:t.progressText,children:["Step ",n.currentIndex+1," of ",n.entries.length," (",Math.round(b),"% complete)"]})]})]}),g.length>0&&e.jsxs("div",{style:t.upcomingSection,children:[e.jsx("h3",{style:t.sectionTitle,children:"Upcoming"}),e.jsx("div",{style:t.upcomingList,children:g.slice(0,5).map((i,o)=>e.jsxs("div",{style:t.upcomingItem,children:[e.jsx("span",{style:t.upcomingNumber,children:n.currentIndex+o+2}),e.jsxs("div",{style:t.upcomingContent,children:[e.jsx("strong",{style:t.upcomingTitle,children:i.title}),e.jsx("span",{style:t.upcomingTime,children:i.isBreak?"5 min break":p(i.estimatedMinutes)})]})]},i.id))})]}),e.jsxs("div",{style:t.blockedSitesSection,children:[e.jsx("h4",{style:t.sectionTitle,children:"Blocked Sites"}),e.jsx("div",{style:t.blockedSitesList,children:n.blockedSites.map(i=>e.jsx("span",{style:t.blockedTag,children:i},i))})]}),e.jsxs("div",{style:t.actions,children:[e.jsx("button",{onClick:x,style:t.primaryButton,children:"Open Study Focus Web App"}),e.jsx("button",{onClick:f,style:t.secondaryButton,children:"End Focus Session"})]})]})})},t={container:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',overflow:"auto"},panel:{background:"white",borderRadius:"24px",padding:"40px",maxWidth:"800px",width:"100%",boxShadow:"0 25px 60px rgba(0, 0, 0, 0.3)"},header:{marginBottom:"32px",paddingBottom:"24px",borderBottom:"2px solid #e5e7eb"},headerContent:{display:"flex",alignItems:"center",gap:"16px"},icon:{fontSize:"48px",lineHeight:1},mainTitle:{margin:0,fontSize:"32px",fontWeight:700,color:"#111827"},headerSubtitle:{margin:"8px 0 0",fontSize:"16px",color:"#6b7280"},hero:{textAlign:"center",padding:"40px 20px"},title:{margin:"16px 0 8px",fontSize:"28px",fontWeight:700,color:"#111827"},subtitle:{margin:"0 0 24px",fontSize:"16px",color:"#6b7280"},timerSection:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"24px",marginBottom:"32px"},timerCard:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px",padding:"32px",color:"white",textAlign:"center"},timerLabel:{fontSize:"14px",opacity:.9,marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px"},timerDisplay:{fontSize:"64px",fontWeight:700,fontVariantNumeric:"tabular-nums",margin:"16px 0",lineHeight:1},completeMessage:{fontSize:"14px",opacity:.9,marginTop:"12px",fontStyle:"italic"},progressBar:{width:"100%",height:"8px",background:"rgba(255, 255, 255, 0.3)",borderRadius:"4px",overflow:"hidden",marginTop:"16px"},progressFill:{height:"100%",background:"white",transition:"width 0.3s ease"},currentTaskCard:{background:"#f9fafb",borderRadius:"16px",padding:"24px",border:"2px solid #e5e7eb"},taskLabel:{fontSize:"12px",textTransform:"uppercase",letterSpacing:"0.5px",color:"#6b7280",marginBottom:"8px"},taskName:{fontSize:"24px",fontWeight:600,color:"#111827",marginBottom:"8px"},taskInfo:{fontSize:"14px",color:"#6b7280",marginBottom:"16px"},progressText:{fontSize:"14px",color:"#667eea",fontWeight:600},upcomingSection:{marginBottom:"32px"},sectionTitle:{margin:"0 0 16px",fontSize:"18px",fontWeight:600,color:"#111827"},upcomingList:{display:"flex",flexDirection:"column",gap:"12px"},upcomingItem:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:"#f9fafb",borderRadius:"12px",border:"1px solid #e5e7eb"},upcomingNumber:{width:"32px",height:"32px",borderRadius:"50%",background:"#667eea",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:600,flexShrink:0},upcomingContent:{flex:1,display:"flex",flexDirection:"column",gap:"4px"},upcomingTitle:{fontSize:"15px",color:"#111827"},upcomingTime:{fontSize:"13px",color:"#6b7280"},blockedSitesSection:{marginBottom:"32px",padding:"20px",background:"#fef3c7",borderRadius:"12px",border:"1px solid #fbbf24"},blockedSitesList:{display:"flex",flexWrap:"wrap",gap:"8px",marginTop:"12px"},blockedTag:{display:"inline-block",padding:"6px 12px",background:"#fbbf24",color:"#78350f",borderRadius:"20px",fontSize:"13px",fontWeight:500},actions:{display:"flex",flexDirection:"column",gap:"12px"},primaryButton:{padding:"16px 24px",background:"#667eea",color:"white",border:"none",borderRadius:"12px",fontSize:"16px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},secondaryButton:{padding:"12px 24px",background:"transparent",color:"#667eea",border:"2px solid #667eea",borderRadius:"12px",fontSize:"14px",fontWeight:600,cursor:"pointer",transition:"all 0.2s"}};j.createRoot(document.getElementById("root")).render(e.jsx(k.StrictMode,{children:e.jsx(B,{})}));
